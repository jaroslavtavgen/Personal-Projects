<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Крестики‑нолики</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: system-ui, sans-serif;
      background: #f0f0f0;
    }

    #size-picker {
      margin-bottom: 24px;
      text-align: center;
    }

    .pick-btn {
      padding: 10px 20px;
      margin: 4px;
      font-size: 18px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background: #444;
      color: #fff;
      transition: background 0.2s;
    }

    .pick-btn:hover {
      background: #666;
    }

    #board {
      display: grid;
      gap: 5px;
    }

    .square {
      width: 100px;
      height: 100px;
      background: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 64px;
      font-weight: bold;
      color: #222;
      cursor: pointer;
      border: 2px solid #444;
      user-select: none;
      transition: background 0.2s;
    }

    .square:hover {
      background: #eaeaea;
    }
  </style>
</head>
<body>
  <div id="size-picker">
    <h2>Выберите размер поля</h2>
    <button class="pick-btn" data-size="3">3 × 3</button>
    <button class="pick-btn" data-size="4">4 × 4</button>
    <button class="pick-btn" data-size="5">5 × 5</button>
    <button class="pick-btn" data-size="6">6 × 6</button>
  </div>

  <div id="board"></div>
  <div id="console"></div>

  <script>
  function checkBoard(X, three, board)
{
  for(let row=0;row<three;row++)
  {
    let won = true;
    for(let column=0;column<three;column++)
    {
      if ( board [ row * three + column ] != X )
      {
        won = false;
        break;
      }
    }
    if(won) return true;
  }
  for(let column=0;column<three;column++)
  {
    let won = true;
    for(let row=0;row<three;row++)
    {
      if ( board [ row * three + column ] != X )
      {
        won = false;
        break;
      }
    }
    if(won) return true;
  }
  let column = 0;
  let row = 0;
  let won = true;
  while(row < three)
  {
    if ( board [ row * three + column ] != X )
    {
      won = false;
      break;
    }    
    column++;
    row++;
  }
  if(won) return true;
  column = three-1;
  row = 0;
  won = true;
  while(row < three)
  {
    if ( board [ row * three + column ] != X )
    {
      won = false;
      break;
    }    
    column--;
    row++;
  }
  if(won) return true;
  return false;
}

function sigmoid(x){
	return 1 / ( 1 + Math.exp(-x) );
}

function sigmoidDerivative ( x ) {
	return x * ( 1 - x );
}

function predict ( input, numberOfInputNeurons, numberOfParallelUniverses, weights01, weights12, b01, b12 ) {
  let sum = b12;
  for ( let universe=0;universe<numberOfParallelUniverses;universe++){
    let universeSum = b01[universe];
    for ( let j=0;j<input.length;j++){
      universeSum += input [ j ] * weights01 [ j * numberOfParallelUniverses + universe ];
    }
    sum += sigmoid ( universeSum ) * weights12 [ universe ];
  }
  return sigmoid ( sum );
}

let weights01 = `-2.828337914681359422e+00 -8.324873157936603096e-01 1.021027222602530315e+00 3.334215222936355083e+00 2.162713066764360814e+00 3.949632382169068645e+00 2.379319219421732967e+00 1.771134847354097985e+00 -4.429184358371592189e+00 1.812418823842907756e+00 4.450259335900745405e+00 -3.541282233604735818e+00 3.333538888834047142e+00 1.497235462708027098e+00 -6.601056709222098640e+00 -5.590531175399156893e+00 4.410510607535588434e+00 2.201845822630052574e+00 -8.248486483687571535e+00 6.321401378251156444e+00 7.706509535503349717e-01 2.163484040270449160e+00 1.382273185763154055e+00 -8.514755191352783470e+00 -7.705955834283853001e+00 -4.748749821848216257e+00 3.021227136021925386e+00 1.030225525874704395e+00 1.190761636739085860e+00 3.561811908193784681e+00 -2.988137364188785838e+00 -3.268441482735630288e+00 4.960996220559463765e+00 -4.969895944017724609e+00 5.043086580424350096e+00 -5.106910455381676428e+00 6.257578242410755109e+00 5.369795238283394667e-01 6.120256661397353248e+00 2.132126333160375253e+00 -4.015702094822822588e+00 6.337139736945019308e+00 3.022643208931343750e+00 1.608035422631122868e+00 -5.791752486999283356e+00 -5.392814800209720261e+00 -2.231892610992474157e+00 3.673681787799460086e+00 -5.863591393475757307e+00 -1.096151958565945428e+01 -5.922341737007172924e+00 4.536984182309298674e+00 4.697236640680364061e+00 6.175314581472501452e+00 8.554566071261364424e-02 -5.832664797978893922e+00 -4.679683907674233367e+00 -6.115807046192298202e+00 2.042277450545892936e+00 2.720687317767918501e+00 -3.274318146030442911e+00 1.033882492376758444e+00 -4.035817419830985742e+00 -4.252929161642639677e+00 1.289412376246027170e-01 5.298587347317473828e+00 2.048983225231496341e+00 1.392423567061248368e+00 3.747886019364931598e-01 4.139430899833880240e+00 3.613868928476541065e+00 -9.002198779768033177e+00 -2.244114238675769812e-01 -8.255457106769722997e-02 7.352383634997585737e-01 7.044568309020442065e+00 -2.884944039765119150e+00 -2.296729402574867684e+00 5.237832216147964459e+00 -6.828969814820772477e+00 -5.596045337182916149e-03 -6.355564058389227888e+00 9.931054119179506756e+00 -4.937503518543614467e-01 6.420194391263687184e-01 5.227057081915259751e+00 -1.690046462436660679e+00 -4.914055853808948271e+00 1.863320555099722942e+00 1.072059767645622230e+01 1.294965777448297828e-01 -2.241619436352513262e+00 -1.021305423467209206e+00 -4.500328638757787325e-01 -7.863641715084029649e+00 -5.715543239063349823e+00 2.771492604592700637e+00 1.021566770999932316e+01 -1.283789435497060483e+00 -1.074558018218602751e+00 -5.446754084772755355e+00 3.354479798144681890e+00 -2.550374734294778900e+00 -2.434921503570945944e+00 8.104072996405044194e+00 5.109808802929839189e+00 1.081827902009713793e-01 -1.294003486347276244e+00 7.387628441926459288e+00 1.179670119712767296e+01 -1.111632814156484983e+01 -5.737816560579458880e+00 -7.919663320240482918e+00 6.105576642492372308e+00 -3.323820655506615207e+00 -2.940455748179575668e+00 -1.924481677574110039e+00 -3.740414125834031212e-01 -3.626780928340464616e+00 3.955122675908991248e+00 6.664983800305538608e+00 2.223954399238011970e+00 -2.229071876437080046e+00 1.070587314820473868e+00 5.216236677403730759e+00 1.404676596386162268e+00 -3.424089669165560679e+00 -1.580955346306533560e+00 -2.651016092127508106e+00 6.434587343566074757e+00 3.065316083243996736e+00 -3.788966199820812619e+00 1.210455033711028916e+00 -5.868753181194175994e+00 4.993460579216688622e+00 2.261179962327189763e+00 4.946843078381666814e+00 2.476413167766337853e-01 1.186927037447033229e+01 2.883912505806605520e+00 -3.890511257086159080e+00 -5.294586981686288940e-02 3.775179554581565622e+00 -7.915208227888209436e+00 -9.302528076262776224e+00 -2.248407317415974660e+00 1.096378390329626562e+01 8.086761378306022152e+00 2.906452413370224974e+00 -2.522177898934514051e+00 -2.403709981554549568e-01 -3.982959299098534522e+00 1.465259769180413951e-01 6.550096245896791736e+00 8.906642613303162870e-01 -3.842403306879962788e+00 1.264375902037189747e-01 -5.709710028128466064e+00 -4.241307540556154443e+00 5.774470754818300300e+00 4.165960670876565075e+00 8.671599799087344351e+00 -9.101358211888657124e-01 -1.948526057084581709e+00 1.096310385794773978e+01 5.722409088362635288e+00 -2.480149546963287932e+00 -4.233724309893157844e+00 5.339477263863804168e+00 2.657006884881863318e+00 -2.290701836347520448e+00 -1.694281145258902388e+00 6.741610616027774228e+00 8.568081902155496365e+00 -1.149057671257424085e+00 5.071742711299590534e-01 2.546981822174026799e+00 4.985565507370929517e+00 -6.641859272134415626e+00 -3.507248007767217679e+00 -1.817492345326642278e-01 3.852001042844345857e+00 1.328290883692660351e+00 5.323864073658896245e+00 6.320804799196016788e+00 3.444868723177327841e+00 -4.265207569275920818e+00 -2.941340973745004028e+00 4.464697361584441637e+00 -1.383297496294709106e+00 -1.731100019837652715e+00 -4.313691768407352356e+00 -1.437146481320635827e+00 7.329746390489693120e+00 4.015409380045301013e+00 9.828357939446895841e+00 -2.478883728094003480e+00 -5.303031104643154414e+00 3.774089780654974469e+00 6.077239962819382946e+00 4.980043582242413613e+00 -1.241048380017270025e+00 -3.790140990257976128e+00 2.307468074082348053e-01 -3.529264074564071318e+00 -1.542050465310621732e+00 4.872539721892115594e+00 -9.341764420423327664e+00 3.543430336727540819e+00 -2.894020407866998212e+00 5.864387502154967180e+00 -1.124622094165800057e+01 -1.990470697926556953e+00 -2.010380470567288747e+00 9.495803875217706524e-01 -4.223671004652274519e+00 -2.153997138416364976e+00 5.180248791541802511e+00 -2.415808015509530282e+00 -3.563016944429469035e+00 -6.063713824786903794e-01 1.253490214725808016e+00 -3.017943487319951767e+00 -3.981835011671337021e+00 -7.842884040967760484e+00 8.725235489917734455e+00 -1.673803561290001740e+00 -2.016903966309264717e+00 -3.261773693175964883e+00 4.299426572056218809e+00 -2.235515189632534483e+00 -3.365384040390988041e+00 7.342468946682958020e+00 -5.346076381613364958e-01 9.038230062264716480e+00 5.046378426859314814e+00 9.709382892660411102e+00 7.809788221926383223e+00 -1.786720262758153543e+00 5.172654094197697283e+00 -2.715513135652154464e-01 6.142400387094594905e+00 -9.849562412030148373e-01 4.176969407038902737e+00 7.247675834141129592e-01 -3.380144234609597120e+00 6.842473611259571875e-01 5.370614927324343313e+00 7.549239690576174056e+00 3.316881470531273024e+00 6.413241976204387740e+00 1.092333097842328371e+01 6.946358951557761507e+00 1.186845080528706964e+00 -2.768979514500109040e+00 4.770899098340373179e-01 1.049446177843131878e+01 -6.452881407268883152e+00 8.724946509800513006e-01 -1.218450728450680698e+00 -1.685809822234416888e+00 -6.877836410316034765e+00 -1.441803436976299313e+00 -1.265478884149983663e-01 6.592141679802308474e+00 -4.519049327195319155e-01 -1.526824761358036797e+00 -6.398636277601453592e+00 4.354563593963219348e-01 1.412184131886008887e+00 -4.520268940016118009e+00 2.919858241280233191e+00 -2.653732284143227371e+00 4.816693709709115034e-01 2.258227800083981440e-01 5.468718619940649006e+00 6.224401544323180380e-01 3.632566232694143804e-01 -2.091618841838665421e+00 3.872337653294253723e+00 7.449891813545442609e+00 2.466184105747490030e+00 -1.760469176472687414e+00 1.655610376378088944e+00 -3.839360845464550587e-01 8.426043977378588679e+00 8.659927547704587170e+00 9.071482729441827431e+00 5.294882089866747243e+00 1.039777191867908568e-01 -2.674253995058378575e+00 1.384083509834257519e+01 -2.815839538394417918e+00 4.297709363022248041e+00 -3.388858585116619526e+00 -2.440935292499792020e+00 -3.022856467097638333e+00 -3.181222433970632757e+00 -1.696141768651194148e+00 1.449442331362619019e+00 -1.732450815714734915e+00 -1.001426576423811166e-01 -2.748446342739989667e+00 -2.139233729578082777e+00 7.890371322922772990e+00 4.470226847640520695e+00 -1.326307969446360646e+00 -1.213457195053047277e+00 1.587356995457272602e+00 -4.871470680048172852e+00 -3.146686047967429012e+00 -1.995037600253966925e+00 5.160980604987569498e-01 4.443415568541490002e-01 -2.803550902054476879e-01 -1.701788665604793138e+00 -7.223076177463251923e+00 4.672120004394179071e-01 -2.981347216049825555e+00 2.576580083952956901e+00 -9.434224784099152217e-01 -5.415922208251792824e+00 -4.629175463188001105e-01 -3.136925756232868401e-01 -3.281457573870891764e+00 6.196135420987257447e+00 -6.011378194650634832e+00 -3.506218852079523995e-01 5.372158792743272571e+00 -4.585524877137300837e-01 -1.426844868560058543e+00 -1.153928233897813238e-01 -5.081045268419058791e-01 -2.247796704937468082e+00 3.527351467107345595e+00 5.302423587354422985e+00 -5.191035072352977453e-01 -4.514368169734253478e+00 -2.564544033722819361e+00 3.240488721343437462e+00 -2.032687486885040862e+00 -4.754050031256391584e+00 -1.108110198396334178e+00 3.481209443210301124e+00 -4.860829031550258250e+00 -4.082420258023632620e+00 -3.656378111749318371e+00 1.605621116413645577e+00 -1.188259575223395537e+00 3.627052761521962765e+00 -3.792455192438151101e+00 9.775309860044426813e+00 1.717730728933605011e+00 -3.827073527420266519e+00 -2.560158838265322423e+00 -3.750426111386797601e+00 -4.421541193719274787e+00 -4.654095093285315343e+00 -2.779432399534558229e+00 -2.254762403583716157e+00 -3.961989421926650934e+00 -8.209073170489057603e+00 -1.367855113317269389e+00 2.283796272686595241e+00 -2.345140846303818805e+00 -9.312878220246666672e+00 1.105073420768527370e+01 -5.354335235746662036e+00 1.376920020912255715e+01 2.720930422452864317e+00 5.980359632095749056e+00 -4.276158608094249303e+00 -6.367943265817650911e+00 -4.270065792757082868e+00 -1.492834883856924977e+00 6.780696046144946365e+00 -2.152137108970378687e+00 2.524004281063087163e+00 -1.181391118241104321e+00 -6.254090787007657859e-01 7.048435078860852965e-01 -1.835984391877028665e+00 -6.080715383051143341e+00 6.371540314997719001e+00 7.562733849252157192e+00 -6.715704970102046367e+00 -2.951493822001476364e+00 -4.126328112153136551e+00 -2.565615450532497288e+00 -2.052940267648449613e+00 1.029178497283019844e+01 1.973925714165063683e+00 2.584579308432127576e+00 -4.782204663923242727e+00 9.399223481180175810e+00 1.456676312377174876e+00 -6.630335222653933880e-02 1.384884097724424112e+00 2.874107850151979004e+00 7.465877863455055774e+00 -8.882676229356430753e+00 4.601534825997626310e-01 4.679724429637699856e+00 1.090875140105739938e+01 3.797151097400948583e+00 2.974205994695118260e-01 1.289880269584391614e+00 4.734616888610630348e+00 -7.432003817499835741e+00 -7.836724626581156317e-01 -2.440145002415220699e+00 1.333316289995925663e+00 -2.029366033458438690e+00 3.615584156374892499e-01 -2.904483650298661068e+00 6.508035979469135590e+00 7.361706584809757814e+00 -2.248600141823948462e-01 -2.963422068748797766e+00 5.086120612581574996e-01 8.583501123924854426e+00 -7.860193030951014848e+00 -2.325792200081216343e+00 -2.937454267629206583e+00 1.787288661090340458e-01 -8.058865085422805663e+00 -6.028114721875832416e+00 2.970476456577619384e+00 -6.410584793618512300e+00 2.385963017564451949e+00 1.901824610906563739e+00 6.085126869321101140e+00 6.474176571655143597e+00 1.370658558131095273e+00 4.068957347434555061e+00 -6.286720880458049443e+00 -8.888043933514708783e+00 -6.898584200104260766e+00 3.038210712502130484e+00 4.809344999512966012e+00 -1.149608989572517226e+00 4.833926657348142975e+00 7.056136126850209855e+00 -3.886080233960726549e+00 4.592266546424590701e-02 -1.035494491635466252e+00 1.308448826848913882e+01 6.076705643577108518e+00 1.089545240842316076e+01 -8.840348364819973881e+00 -5.215891855526640697e+00 8.986151698691628553e+00 -2.119589789183234263e+00 1.963518676738915669e+00 -3.605719924706799695e+00 1.497275091615268616e+00 9.242179552119781150e+00 -1.958203539609227661e+00 -3.717561148359405543e+00 -2.607014185290433161e+00 1.063505380719315996e+00 5.421838102172896745e-01 -1.081978877917747495e+00 8.136034228209151564e+00 -2.527463635479338944e+00 2.238953006321812156e-01 -5.899522668261591996e+00 -4.295809751823487788e-01 -9.233886832004331024e-01 1.708750763940334538e+00 1.206642537924307756e+00 2.417637817862493321e+00 3.194206305676531077e+00 -4.107129771281073927e-01 -1.846031790746306855e+00 -1.226931069637190896e+00 9.476933049359975714e-01 1.091957141916749663e+01 -7.746128688880472568e-01 6.984037285288357211e+00 -6.295197520060658469e+00 -2.291838891082471630e+00 -2.812683885062395639e+00 -6.072871124656931130e+00 -2.989090135568691409e+00 -1.422162752070344816e+00 -1.741409073964159671e+00 1.698387059964428625e+00 -6.744308044237639077e-01 -1.294736238997989375e+01 7.489521769520163907e+00 2.709397557991269703e-02 -1.468646419057558106e+01 2.995354953582301860e+00 6.059260614063171069e+00 3.834352391063378107e+00 6.149518767485589343e+00 4.749919300147497303e+00 2.730074717475333035e+00 3.468554025072212887e+00 5.000322349825904844e+00 -1.181602402646795902e+01 -6.035455199631970524e-01 5.735261757148230721e+00 -4.927468089186647582e+00 4.641473161305315287e+00 -2.323731991605056724e+00 8.794126061703687824e+00 -3.475128129271104704e+00 2.394064081734277316e+00 8.273289013940372805e-02 9.536312015439015966e+00 -4.005589409661321376e+00 6.443658050708115148e+00 -7.716582952307258214e-01 -2.113670012943809517e+00 -3.679189677749624465e+00 -1.660829923100461958e+00 -2.152722002975187010e+00 -5.520981336828572061e+00 -2.017509175311945402e+00 -1.603274653799010574e+00 -2.312455987354487430e+00 -5.545657604960704923e+00 -1.480585132621577094e+00 3.967858395940738081e+00 -1.667392625450978105e+00 3.739350153042053204e+00 4.526038457535206838e+00 2.391052407548863279e+00 2.131780921916357929e+00 -1.341876823629214899e+00 9.291801618274403429e-01 3.278383160583802525e+00 -2.657210854905715625e+00 5.148507983255567133e+00 5.742572769986542980e+00 2.031865943515320794e+00 -3.639572301363616535e+00 2.743548381677111681e-01 -1.789282833363235348e+00 2.183266624498001254e-02 1.178945571487020061e+01 1.210683232365162398e+00 -7.186171527282810167e+00 -1.533046272329904314e+00 -3.916146444602369492e+00 8.890145852894619338e+00 -1.603842188557573545e+00 8.858642157422405461e+00 -4.749168848798814402e+00 -3.487818546369807038e+00 1.907885191874970854e+00 9.638824109036650545e-02 -1.259455262325438918e+00 -2.808008275315200475e+00 7.120775866725030490e+00 1.621089900612642465e+00 -3.614778021719943446e+00 -1.073776004459042310e+00 -2.372153614952724698e+00 5.319592337090932155e+00 1.375562535869007563e+00 -7.646520855862356747e+00 -4.523864501514227143e+00 -4.082331482187519178e+00 -3.449483957397962541e+00 -3.935743053767839950e+00 -7.050471167022802632e-01 2.112200617459034646e+00 -3.231902538518411028e+00 -1.960509697318647104e+00 -5.530329368080644237e+00 -1.468265126580080793e+00 7.936499261701087660e-01 2.792799623824092414e+00 -6.970185723702279623e-02 1.948056918876452270e+00 1.023234774722602269e+00 -3.948391220511112909e+00 -4.158856354915649867e+00 3.009295677828621729e-01 3.177189306735862306e+00 -5.665769920326946263e+00 -4.383912005143115742e+00 -2.140255492628330369e+00 -5.904059261083356880e+00 1.498808311781563818e+00 -2.305475167757321753e+00 -5.916604256377953064e+00 1.247283642904107315e-01 5.746997857512726959e+00 2.863465815112364421e+00 -4.106270570507610351e+00 1.332019564049810700e+00 -3.220476020022563279e+00 -5.455146462392572726e-01 1.707341659810473589e+00 3.168818935786106294e-01 5.578985125362178721e+00 -5.979937477194311457e-01 -2.559028226555930097e+00 -4.436731587755123662e+00 1.403267097693686516e+00 -1.315967847760451503e+00 -3.018094387688754487e+00 -3.470584900648500337e+00 -3.699278533554694715e+00 -9.586643999178315667e+00 -6.205477334197166073e+00 -4.385578001390746827e+00 1.544660353180588253e+00 -3.920554285186736987e+00 -4.033162394093216641e+00 -5.293435444274345869e+00 5.414587553151080535e+00 -4.006610338811867678e+00 6.496908532566265215e+00 -5.530902182389137778e+00 2.850612326539538444e+00 8.689109927861540683e+00 5.252328603295089993e-01 6.804415647458602834e+00 -9.012218474314497740e+00 -1.484741361236489920e+00 4.831130443731176172e+00 8.050339329415892919e+00 -5.309957330655826979e+00 -3.953541224475887628e+00 1.025196732656971310e+00 2.840846399405009493e+00 5.882129203799273398e+00 5.671991119246113655e-01 2.654901341246312718e+00 3.363537258962311149e+00 -3.112620275360148181e+00 6.657393827821045384e+00 -2.042908880435676977e+00 1.869835399786492491e+00 -4.928060280635370383e+00 -4.080323910587189573e+00 5.852292299335952741e+00 -3.577184916585147256e+00 -3.307192833260285347e+00 -1.580928581155664814e+00 -9.558975067365711453e-01 -3.466229787681658348e+00 9.325249706769338232e-02 -5.538265927650292575e+00 -2.971187906617215546e+00 8.590560066107959969e+00 5.566135680320684287e+00 -3.389772772367101616e+00 2.956322816307197954e+00 9.791046021331538896e+00 6.596030236135626446e+00 -3.131879279589421028e+00 2.149613018247185980e+00 5.164298915469170304e+00 -2.745367482896788669e+00 3.848224085711505538e+00 -5.364371565142469045e+00 -1.460033940788819873e+00 5.589144382874607686e+00 4.803412315265331856e+00 3.247385821764982694e+00 -1.249449807247225097e+00 -1.819807102777324659e-01 -1.143650860826925131e+00 -2.291564911016977124e+00 -8.533445358860639374e+00 -1.809289125615605398e+00 -3.204818342183377577e+00 6.140374558044304543e+00 -3.977687511248835239e+00 -1.637229728717259247e+00 9.816005406605132322e+00 -7.772334231226789569e+00 -4.292966508517223723e+00 -4.192665452889902333e+00 -6.078042445774914704e+00 -1.363713789310177615e+00 -4.442896760133242751e+00 -2.655631954122194660e+00 5.240818211821629546e+00 -5.553909155271339326e-01 6.797286525438540616e-01 1.053602396180701062e+00 2.273674888124951554e+00 4.443796931288762408e+00 4.026596310539241053e+00 3.841659755572803259e-01 -2.687218472963360583e+00 3.148184720142596760e+00 -8.453932797475384453e-02 3.764115470040668932e+00 -5.410371896040540030e+00 3.602767942263315870e+00 -3.284958187013349296e+00 -2.468061406567872762e+00 5.946000207171286078e+00 2.515474247574708055e+00 1.781378933275499676e+00 2.456063693871086251e+00 1.369407925140357252e+00 5.909210490455335751e+00 -7.535014755152966703e-01 1.008846587252846838e+01 -1.567211692212490348e+00 6.705706198128603468e+00 -1.468668568230236948e+00 -2.913067347817738906e+00 -4.839311695488145992e-01 -2.076261100014039851e+00 -5.316319586035564093e+00 8.507911383604264799e+00 -3.458654761924404575e+00 1.781229903409094595e+00 -4.838848004621221222e+00 1.457928260014098587e+00 1.931962552045773274e+00 4.904576141933852940e-01 1.534231373471977244e+00 -6.951739978397117881e-01 -1.556233318436070823e+00 6.786009452590799906e-01 -1.935589680023102499e+00 5.920128570234478360e+00 4.116718602316237430e+00 3.241445980905591107e+00 -1.284328599934248638e+00 -4.707727189579645199e-01 6.936722235288639293e-01 3.384349279636983399e-01 -1.017052788736018121e+00 -3.287055499283261017e+00 -7.610210963954532559e+00 5.629855033480336779e+00 -3.551223430801215386e+00 6.112037566217299656e+00 -2.557819597415619484e+00 -4.590070381934168608e+00 -3.608627033959518116e+00 2.076228043339329865e+00 4.522520009121038242e+00 -3.000589071252612872e+00 8.947280248722261575e+00 -1.227907107316248858e+00 9.077214173097956973e+00 2.672542403425810065e+00 8.244889324191234437e+00 -1.650458568450056951e-01 2.008772002190255090e+00 6.002866116737853197e+00 2.944252863018668176e+00 6.821095359700793281e+00 -1.791579037577203604e+00 -3.938210846896105011e+00 -5.615632250228369315e+00 4.141318354846952765e+00 -1.952649019531824237e+00 2.267985755031378226e+00 -3.083390515540118226e+00 8.489179260401961358e+00 6.631718703084184874e+00 5.822542028914071688e-01 5.209952176906774701e-01 3.299089686984345349e+00 -3.089755117250725824e+00 7.812644837833317979e+00 -2.045267739220731684e+00 -3.439142893623718056e+00 8.540712165021902891e+00 -8.241455567811536653e+00 -8.221398955248332641e+00 2.613130415339485424e+00 -4.817297059274039839e+00 8.221202243771466911e+00 -2.994134313165057293e+00 -6.549691551690954849e-01 6.597830786595164199e+00 -1.035249961154401793e-01 3.014191440242710573e+00 8.496945462782337088e+00 2.197388532812575956e+00 6.129931584811498801e+00 -6.604323571220521494e+00 -2.868625254881228326e+00 -1.218155083944547634e+00 -2.289236951535597697e+00 3.353620392672421069e+00 6.964615422411127632e+00 9.734594517757855670e+00 -3.223721733976990134e+00 7.591643153341517625e+00 -2.588352166561020962e+00 3.329009140906810327e+00 -1.920293191844075764e+00 9.923686506332241919e+00 -1.219244859546190218e+00 4.266376312583961550e+00 -7.331735736216565158e+00 1.014462060361839590e+01 8.223531189686445586e+00 -4.455168514427534809e+00 5.352492377365122067e+00 1.043670852061657328e+01 -3.229794935524684885e+00 4.182080033931350194e+00 5.206501545594699465e+00 1.921058079648380879e-01 1.430317491392323337e+00 9.470234279690602719e+00 2.505342301274844807e+00 -3.187403144472153560e+00 3.671175156521314431e+00 3.872535916086152330e+00 7.048735419781419154e+00 7.449671397620928337e-01 1.425470274371461565e+00 8.411639687577478597e+00 3.727276297358636192e+00 6.900340357177784378e-01 -1.316438360013665232e+01 7.301585458139459917e+00 -1.184505911705448966e+01 5.023026080772056368e+00 -3.361307598030461641e+00 -4.067134672434486120e+00 1.070172217180792140e+00 5.852184544815973055e+00 -4.538704762122923064e+00 1.845665841478383529e+00 -2.928059493467400354e-01 4.459421798312100949e-01 -2.265289116734023889e+00 9.143036858857378490e+00 -1.786349542004354030e+00 -6.489227218230359640e+00 9.132270085809524929e+00 -3.914887105921490473e+00 7.225315394605028807e+00 -6.674402758345372721e-02 4.935086260478927400e+00 8.724279801723492156e+00 -2.365027118568780562e+00 3.449304221267994297e+00 4.110834402972932899e+00 -9.209076453111066929e-01 -4.906911841367342042e+00 8.716763921216585942e+00 -3.130723992313433346e+00 -1.788523091558149036e-01 -8.232899764898327089e-01 2.936293832023904038e+00 1.550444631913008520e+00 2.179290086413443461e+00 -8.904431897853681832e+00 8.205378058175334388e+00 -1.899404172543724956e-01 3.959962751164042949e+00 -3.370758501086704051e+00 9.534960213736100698e+00 -1.600920668734126195e+00 -5.180351889760637096e-01 -2.874012866043105685e+00 9.130936762830989650e+00 9.126600801183994971e-01 -3.960505875107251494e+00 9.103963026363564026e+00 8.557409472260744110e+00 4.880663137603111323e+00 -1.742227901656313360e+00 -1.357086343767858416e+00 -7.919163194146559004e-01 -5.980181557041744922e-01 7.961792331894709029e+00 -5.786553472242562890e+00 7.468842627344058904e+00 -5.831501320767229934e+00 -6.290949430796363373e+00 1.469238168199520800e+00 4.976305755169319944e+00 8.806633786425646093e+00 8.711694003031460909e+00 6.752214618306888738e+00 -1.204862784413018639e+00 7.028439971155143517e+00 9.821154259423289901e+00 6.415681555346907317e+00 2.006409724807816541e+00 -2.193989956236148231e+00 5.793521310278910263e+00 2.491354146768211208e+00 5.955369265818204916e+00 4.111026094636153871e+00 -5.201689148766448945e+00 7.561145546391751182e+00 -3.168817533528974550e+00 -1.203813361846813867e+00 1.070032162180191726e+01 -6.746734598582277975e+00 -6.208727683784911022e+00 2.534131349312105375e+00 3.345964607424766424e+00 8.985836040393591517e+00 1.027573271699417212e+01 5.806634449388320185e+00 -1.042500615721409041e+01 -2.888645955200416005e+00 3.112067129321845371e+00 3.150577570052696785e+00 -3.892905456580701973e+00 2.744500275478286788e+00 4.568189042977350289e-01 -1.844176444484973310e+00 3.014903713508474414e+00 -2.290541506621836643e+00 2.843174988027913130e+00 3.804269310191243481e+00 2.699302207766732131e+00 2.569874297444027622e+00 9.764573229222319739e+00 3.003242330944557281e+00 4.152559042080280705e+00 -5.090193264840002563e+00 8.201290081559148959e+00 -7.123753066270422929e-01 4.672346378373849696e+00 4.937975648635816839e+00 9.995102080985292403e+00 1.569058536958620742e+00 9.415236485116210474e+00 4.458018095635039479e+00 9.470653391729749515e+00 -4.241118072455458687e+00 -2.333879594229326671e+00 2.143162940629028679e+00 3.842462673582035748e+00 1.173740529223455287e+00 3.319470655397765757e+00 3.503731456247071829e+00 2.383942133164947297e+00 -1.203890442891735413e+00 -3.001509523865016904e-01 -1.290288501943965471e+01 7.789301530582328770e-01 8.757898470091486587e+00 4.918132652798277604e+00 4.423025054843831683e+00 -2.633458088239292838e+00 7.473451018306380256e+00 -1.426515414686749583e+00 7.214434555703161500e+00 1.332396474284555099e+00 -1.309313005493383697e+00 6.903755433552844600e+00 1.134866245796019690e+00 5.306725030961245260e+00 -3.392536311530616189e+00 -3.838920010351355216e+00 8.048775069092251044e+00 -8.233543837401331444e+00 1.020769916537720157e+01 1.110491968717732192e+01 -1.960368896207672185e+00 -3.980497962743988261e+00 5.631486708089309623e+00 -3.472914272925335499e+00 9.117898696555917226e+00 -4.139774657250453238e+00 6.281309904941532629e+00 4.500745040662375573e-01 1.443967626464415455e+00 3.259796121248822232e+00 1.154691776615789145e+01 4.044302199491023764e+00 1.783874442272309346e-01 -4.430086443191095569e+00 -3.111623026512843282e+00 -1.362862949047883410e+00 -3.567692617396560184e+00 3.018881060301817687e+00 1.113106894313143513e+01 5.238761991800859441e+00 6.571395936473113153e+00 9.645873513388021792e+00 -3.409617489570488935e-01 3.594974362241581733e+00 -1.431129884545654152e+00 2.594657573498891368e-01 -2.624233499303435302e+00 7.102585893837618514e-01 2.364423011495688343e+00 1.129921333876600009e+01 -1.477877395240894565e+00 -1.570195458826772583e+00 -4.695350886883211672e+00 1.006432496589953729e+01 5.537423762755666168e+00 3.554784783911075330e+00 -3.329597982947022583e+00 7.866837576103724139e+00 -1.106015705978324659e+00 8.777805445474790247e+00 -1.207054671643605248e+00 4.836782799584731229e+00 3.543437983260938395e+00 5.695745857107266108e-01 5.334490666703642248e+00 8.429895913368333993e+00 5.915086804053126812e+00 8.754501981726034998e+00 -6.923040981775548275e+00 3.518785392088545017e+00 6.627952290494251386e+00 2.195968753948477126e+00 4.818488439508015198e+00 1.555300206594879775e+00 9.684628651539087585e+00 4.330815959233696333e+00 6.715036457035600259e-01 5.720822950752796565e+00 -2.769157214441227755e+00`.split(` `).map(Number)

let weights12 = `-5.121543961069344064e+00 -5.482120633800386500e+00 6.068723262794054385e+00 5.339798199023243264e+00 3.619851933800270594e+00 7.483164597617348868e+00 9.590490562778580141e+00 3.576791062187949510e+00 -4.910488376245749187e+00 3.256711851809758418e+00 5.615138389087185544e+00 -4.926472233870749839e+00 5.030545973564514384e+00 4.356432480870284785e+00 -4.583840674664473980e+00 -6.474550732229909400e+00 5.736753435979066396e+00 6.901768617105537018e+00 -6.950870191712987811e+00 4.808519978197280054e+00 2.511404451903497925e+00 6.141587176649620616e+00 1.931425084993098285e+00 -6.332724476752419562e+00 -6.601103400152600109e+00 -5.234612636601459812e+00 3.129013922809234849e+00 4.544187708163700989e+00 2.204006718094804640e+00 5.394037433840788154e+00 -7.146179362110330224e+00 -3.938793997271456959e+00 5.256696939053149720e+00 -6.021191079758092535e+00 4.221851934085343316e+00 -7.152802241998561961e+00 5.742440131024256544e+00 -4.630964635277782904e+00 4.397470160900125435e+00 5.645270140979444129e+00 -5.982910116233758124e+00 4.971275668058267705e+00 4.807943110271271969e+00 2.135016680210564566e+00 -5.862177558965009361e+00 -5.905453781158830573e+00 -5.599584863975855420e+00 7.683877093839986294e+00 -4.760346179527267907e+00 -5.389032882097786192e+00 -5.493457389116723100e+00 3.459057550886370791e+00 3.653416327840513400e+00 4.791199265747564162e+00 8.035583462630167872e+00 -6.733041105762062273e+00 -4.586264153733591087e+00 -5.497307413999608094e+00 3.059087743733129194e+00 5.075930739726952190e+00 -5.337105010224377999e+00 1.703426891224826933e+00 -6.153241913594394319e+00 -3.910026989831439703e+00`.split(` `).map(Number);

let b01 = `-2.879140305242052111e+00 -8.806362493824352322e-01 1.660279179452369691e+00 3.158528694336971032e+00 2.652641957271653528e+00 4.478856424072776399e+00 1.902416995559451429e+00 1.863768894928195641e+00 -5.111807727679551938e+00 2.109693494086079202e+00 4.751796173689927016e+00 -3.125380067785744398e+00 2.850858718665814973e+00 1.248687761963824805e+00 -6.503119206461122737e+00 -5.892221524497060159e+00 4.215151953399386642e+00 2.629231732440274083e+00 -8.601075836792102081e+00 6.464213351252649176e+00 9.724034700853405599e-01 1.528373380239500090e+00 1.030680267167697561e+00 -8.166338760050502188e+00 -7.200588939968453062e+00 -4.860822539572239975e+00 2.869083179233117953e+00 1.107107907947401548e+00 1.310959341331385586e+00 3.347365527792380391e+00 -3.152527265710123761e+00 -3.762848544476652624e+00 4.504264372677429407e+00 -5.012825263935861919e+00 4.640948862995002422e+00 -5.091864139850087234e+00 6.858159673315040727e+00 -1.009899789494489303e-01 6.330076501521865850e+00 2.455614230700169376e+00 -4.059673079953147301e+00 6.955351174066945141e+00 3.173176073402522501e+00 8.445587833716202697e-01 -5.756603605518815669e+00 -5.406017659568105316e+00 -2.033124319254900225e+00 3.730290422568088626e+00 -6.244828918699441900e+00 -1.074235413429041053e+01 -5.324113388797275803e+00 4.612819596854115467e+00 4.301584170479713976e+00 7.023357383809063492e+00 1.374213476850352500e-01 -6.673643549172185274e+00 -4.692535280170691436e+00 -7.086867141425835293e+00 2.344575027979537207e+00 3.020506197532912385e+00 -3.308594965063016424e+00 9.603133441266241688e-01 -3.859320821687040048e+00 -3.518377377238529391e+00`.split(` `).map(Number);

let b12 = 1.008996133793977679e+00;

    const picker = document.getElementById("size-picker");
    const board1 = document.getElementById("board");

    picker.addEventListener("click", (e) => {
      const btn = e.target;
      const size = parseInt(btn.dataset.size, 10);
      if (size) {
        picker.style.display = "none";
		boardSideLength = size;
        buildBoard(size);
      }
    });

    function buildBoard(size) {
      board1.innerHTML = ""; // очищаем поле, если уже было
      board1.style.gridTemplateColumns = `repeat(${size}, 100px)`;
      board1.style.gridTemplateRows = `repeat(${size}, 100px)`;
      for (let i = 0; i < size * size; i++) {
        const cell = document.createElement("div");
        cell.classList.add("square");
		cell.id = i;
        board1.appendChild(cell);
	  }
      let boardSideLength = size;
	  let boardLength = boardSideLength**2;
	  let board = Array.from({length:boardLength}, _=>0);
  	  let computerPlayer = 0.9;
      let current = "X";
	  let humanPlayer = 0.1;
	  let numberOfParallelUniverses = 64;
	  makeAMove (board, computerPlayer, boardSideLength, numberOfParallelUniverses, weights01, weights12, b01, b12 );
	  for (let i = 0; i < size * size; i++) {
		let cell = document.getElementsByClassName(`square`)[i];
        cell.addEventListener("click", () => {
          if (cell.textContent === "") {
		    let current = humanPlayer == 0.1 ? "0":"X";
            cell.textContent = current;
			board[+cell.id] = humanPlayer;
			if ( checkBoard(computerPlayer, boardSideLength, board) ) {
			  for (let i = 0; i < size * size; i++) {
				var old_element = document.getElementsByClassName(`square`)[i];
				var new_element = old_element.cloneNode(true);
				old_element.parentNode.replaceChild(new_element, old_element);
			  }		
			}
			else makeAMove ( board, computerPlayer, boardSideLength, numberOfParallelUniverses, weights01, weights12, b01, b12 );
          }
        });
      }
    }
	function makeAMove( board, whoseTurn, boardSideLength, numberOfParallelUniverses, weights01, weights12, b01, b12 ){
		let start = performance.now();
		let emptySquaresIndices = [];
		for ( let i=0;i<board.length;i++){
			if(board[i] == 0) emptySquaresIndices.push(i);
		}
		if(emptySquaresIndices.length==0) return;
		let bestMove = -1;
		let bestScore = -1;
		for ( let i=0;i<emptySquaresIndices.length;i++){
			let emptySquareIndex = emptySquaresIndices[i];
			board[emptySquareIndex] = whoseTurn;
			let score = predict ( board, boardSideLength, numberOfParallelUniverses, weights01, weights12, b01, b12 );
			board[emptySquareIndex] = 0;
			if ( score > bestScore ) {
				bestScore = score;
				bestMove = emptySquareIndex;
			}
		}
		board [ bestMove ] = whoseTurn;
		let current = whoseTurn == 0.1 ? "0":"X";
		document.getElementsByClassName(`square`)[bestMove].textContent = current;
		document.getElementById(`console`).textContent = `${(performance.now()-1000)/1000} seconds it took to calculate`;
		if ( checkBoard(whoseTurn, boardSideLength, board) ) {
		  for (let i = 0; i < size * size; i++) {
			var old_element = document.getElementsByClassName(`square`)[i];
			var new_element = old_element.cloneNode(true);
			old_element.parentNode.replaceChild(new_element, old_element);
		  }		
		}
	}
  </script>
</body>
</html>
